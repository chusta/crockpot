filter {
  if [sensor] {
    mutate { update => { "sensor" => "%{host}" } }
  } else {
    mutate { add_field => { "sensor" => "%{host}" } }
  }

  if [src_port] {
    mutate { convert => { "src_port" => "integer" } }
  }
  if [dst_port] {
    mutate { convert => { "dst_port" => "integer" } }
  }
}

output {
  http {
    codec => json
    http_method => post
    url => "http://127.0.0.1:9999"
  }
}
